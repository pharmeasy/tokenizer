# last updated - 20220601
# This is the base image used for the first stage build for docker
# The image was prebuilt and fetched from ECR as it requires http based packages from debian
# which was insecure and not allowed by the firewall
# the docker build command sets the arg based on the env so that the respective ECR is used
# to build the image (this is set at the jenkins build level)
# to build the project locally, build the above image and fetch from local docker
# or replace the first two lines of the dockerfile with the lines mentioned below
# since the access to the ECR image is not permitted on local machines
FROM golang:1.13.0 AS builder
RUN mkdir -p /root/.ssh
RUN mkdir -p /etc/ssh/
RUN apt-get update && \
    apt-get install -y \
        python3 \
        python3-pip \
        python3-setuptools \
        openssh-client \
        git \
        ca-certificates \
    && pip3 install --upgrade pip \
    && apt-get clean

RUN pip3 --no-cache-dir install --upgrade awscli==1.14.5 s3cmd==2.0.1 python-magic